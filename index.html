<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Ouvir e Digitar</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f3f3f3;
      text-align: center;
      padding: 50px;
    }
    input, button {
      padding: 10px;
      font-size: 18px;
      margin: 10px;
      width: 80%;
      max-width: 400px;
    }
    #feedback {
      font-size: 20px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Gmk Idiomas</h1>
  <button onclick="playAudio()">ğŸ”Š Ouvir frase</button><br>
  <input type="text" id="answerInput" placeholder="Digite aqui o que ouviu">
  <br>
  <button id="verifyButton" onclick="handleButtonClick()">Verificar</button>
  <button id="restartButton" onclick="restartActivity()" style="display:none;">ğŸ”„ Refazer atividade</button>
  <div id="feedback"></div>

  <script>
    const allPhrases = [
  "She's not single",
  "Where does she live?",
  "I'm married",
  "Where are you from?",
  "Are you married?",
  "She's single",
  "Are you in a relationship?",
  "Where do they live?",
  "Is he married?",
  "I'm from Brazil",
  "She's in a relationship",
  "Where do you live?",
  "You're not married",
  "She's lives in Brazil",
  "He's from Portugal",
  "Are you single?",
  "Where are you from?",
  "I'm in a relationship"
    ];

    let phrases, currentPhrase, currentIndex, awaitingNext, correctCount;

    function shuffleArray(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function playAudio() {
      if (currentPhrase) {
        const utterance = new SpeechSynthesisUtterance(currentPhrase);
        utterance.lang = "en-US";
        speechSynthesis.speak(utterance);
      }
    }

    function handleButtonClick() {
      if (awaitingNext) {
        loadNextPhrase();
      } else {
        checkAnswer();
      }
    }

    function checkAnswer() {
      const userAnswer = document.getElementById("answerInput").value.trim().toLowerCase();
      const correctAnswer = currentPhrase.toLowerCase();
      const feedback = document.getElementById("feedback");

      if (userAnswer === correctAnswer) {
        feedback.textContent = "âœ… Muito bem! Resposta correta.";
        feedback.style.color = "green";
        correctCount++;
      } else {
        feedback.textContent = `âŒ Resposta incorreta. A frase era: "${currentPhrase}"`;
        feedback.style.color = "red";
      }

      document.getElementById("verifyButton").textContent = "PrÃ³xima frase";
      awaitingNext = true;
    }

    function loadNextPhrase() {
      currentIndex++;

      if (currentIndex >= phrases.length) {
        document.getElementById("feedback").innerHTML =
          `ğŸ Fim do exercÃ­cio!<br>âœ… VocÃª acertou ${correctCount} de ${phrases.length} frases.`;
        document.getElementById("verifyButton").style.display = "none";
        document.getElementById("answerInput").style.display = "none";
        document.getElementById("restartButton").style.display = "inline-block";
        return;
      }

      currentPhrase = phrases[currentIndex];
      playAudio();

      document.getElementById("answerInput").value = "";
      document.getElementById("feedback").textContent = "";
      document.getElementById("verifyButton").textContent = "Verificar";
      awaitingNext = false;
      document.getElementById("answerInput").focus();
    }

    function restartActivity() {
      phrases = shuffleArray([...allPhrases]);
      currentPhrase = phrases[0];
      currentIndex = 0;
      awaitingNext = false;
      correctCount = 0;

      document.getElementById("answerInput").value = "";
      document.getElementById("answerInput").style.display = "inline-block";
      document.getElementById("verifyButton").textContent = "Verificar";
      document.getElementById("verifyButton").style.display = "inline-block";
      document.getElementById("restartButton").style.display = "none";
      document.getElementById("feedback").textContent = "";

      playAudio();
      document.getElementById("answerInput").focus();
    }

    document.getElementById("answerInput").addEventListener("keydown", function (event) {
      if (event.key === "Enter") {
        event.preventDefault();
        handleButtonClick();
      }
    });

    window.onload = () => {
      restartActivity();
    };
  </script>
</body>
</html>

